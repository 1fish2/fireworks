{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$ref": "#/Firetask",
  "Firetask": {
    "oneOf": [
      {
        "$ref": "#/definitions/BuiltinFiretask"
      },
      {
        "$ref": "#/definitions/CustomFiretask"
      }
    ]
  },
  "definitions": {
    "ScriptTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "ScriptTask"
        },
        "script": {
          "type": [
            "string",
            "array"
          ],
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "defuse_bad_rc": {
          "type": "boolean",
          "default": false
        },
        "fizzle_bad_rc": {
          "type": "boolean",
          "default": false
        },
        "use_shell": {
          "type": "boolean",
          "default": true
        },
        "shell_exe": {
          "$ref": "generic.json#/AbsoluteFilePath",
          "default": null
        },
        "stdin_file": {
          "$ref": "generic.json#/FilePath",
          "default": null
        },
        "stdin_key": {
          "type": "string",
          "default": null
        },
        "store_stdout": {
          "type": "boolean",
          "default": false
        },
        "stdout_file": {
          "$ref": "generic.json#/FilePath",
          "default": null
        },
        "store_stderr": {
          "type": "boolean",
          "default": false
        },
        "stderr_file": {
          "$ref": "generic.json#/FilePath",
          "default": null
        },
        "_use_global_spec": {
          "const": false
        }
      },
      "required": [
        "_fw_name",
        "script"
      ]
    },
    "PyTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "PyTask"
        },
        "func": {
          "type": "string"
        },
        "args": {
          "type": "array",
          "default": []
        },
        "kwargs": {
          "type": "object",
          "default": {}
        },
        "auto_kwargs": {
          "type": "boolean",
          "default": false
        },
        "stored_data_varname": {
          "oneOf": [
            {
              "$ref": "generic.json#/Identifier"
            },
            {
              "const": null
            }
          ],
          "default": null
        },
        "inputs": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "default": [],
          "uniqueItems": true
        },
        "outputs": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "default": [],
          "uniqueItems": true
        },
        "chunk_number": {
          "oneOf": [
            {
              "type": "integer",
              "minimum": 0
            },
            {
              "const": null
            }
          ],
          "default": null
        }
      },
      "required": [
        "_fw_name",
        "func"
      ]
    },
    "FileWriteTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "FileWriteTask"
        },
        "files_to_write": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "filename": {
                "$ref": "generic.json#/Filename"
              },
              "contents": {
                "type": "string"
              }
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "dest": {
          "$ref": "generic.json#/FilePath",
          "default": "./"
        }
      },
      "required": [
        "_fw_name",
        "files_to_write"
      ]
    },
    "FileDeleteTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "FileDeleteTask"
        },
        "files_to_delete": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "dest": {
          "$ref": "generic.json#/FilePath",
          "default": "./"
        }
      },
      "required": [
        "_fw_name",
        "files_to_delete"
      ]
    },
    "FileTransferTaskType1": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "FileTransferTask"
        },
        "files": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "src": {
                "$ref": "generic.json#/FilePath"
              },
              "dest": {
                "$ref": "generic.json#/FilePath"
              }
            },
            "required": [
              "src",
              "dest"
            ]
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "mode": {
          "enum": [
            "move",
            "copy",
            "copy2",
            "copytree",
            "copyfile",
            "rtransfer"
          ],
          "default": "move"
        },
        "ignore_errors": {
          "type": "boolean",
          "default": false
        },
        "shell_interpret": {
          "type": "boolean",
          "default": true
        },
        "key_filename": {
          "$ref": "generic.json#/FilePath"
        },
        "server": {
          "anyOf": [
            {
              "$ref": "generic.json#/Hostname"
            },
            {
              "$ref": "generic.json#/IPAddress"
            }
          ]
        }
      },
      "required": [
        "_fw_name",
        "files"
      ]
    },
    "FileTransferTaskType2": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "FileTransferTask"
        },
        "dest": {
          "$ref": "generic.json#/FilePath"
        },
        "files": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/FilePath"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "mode": {
          "enum": [
            "move",
            "copy",
            "copy2",
            "copytree",
            "copyfile",
            "rtransfer"
          ],
          "default": "move"
        },
        "ignore_errors": {
          "type": "boolean",
          "default": false
        },
        "shell_interpret": {
          "type": "boolean",
          "default": true
        },
        "key_filename": {
          "$ref": "generic.json#/FilePath"
        },
        "server": {
          "anyOf": [
            {
              "$ref": "generic.json#/Hostname"
            },
            {
              "$ref": "generic.json#/IPAddress"
            }
          ]
        }
      },
      "required": [
        "_fw_name",
        "dest",
        "files"
      ]
    },
    "CompressDirTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "CompressDirTask"
        },
        "compression": {
          "enum": [
            "gz",
            "bz2"
          ],
          "default": "gz"
        },
        "dest": {
          "$ref": "generic.json#/FilePath",
          "default": "./"
        },
        "ignore_errors": {
          "type": "boolean",
          "default": false
        }
      },
      "required": [
        "_fw_name"
      ]
    },
    "ArchiveDirTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "ArchiveDirTask"
        },
        "base_name": {
          "$ref": "generic.json#/FilePath"
        },
        "format": {
          "enum": [
            "zip",
            "tar",
            "bztar",
            "gztar"
          ],
          "default": "gztar"
        }
      },
      "required": [
        "_fw_name",
        "base_name"
      ]
    },
    "TemplateWriterTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "TemplateWriterTask"
        },
        "template_file": {
          "$ref": "generic.json#/FilePath"
        },
        "context": {
          "type": "object"
        },
        "output_file": {
          "$ref": "generic.json#/FilePath"
        },
        "append": {
          "type": "boolean",
          "default": false
        },
        "template_dir": {
          "$ref": "generic.json#/AbsoluteFilePath"
        }
      },
      "required": [
        "_fw_name",
        "template_file",
        "context",
        "output_file"
      ]
    },
    "AddFilesTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "AddFilesTask"
        },
        "paths": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/FilePath"
          },
          "uniqueItems": true
        },
        "identifiers": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "uniqueItems": true
        },
        "filepad_file": {
          "$ref": "generic.json#/AbsoluteFilePath"
        },
        "compress": {
          "type": "boolean"
        },
        "metadata": {
          "$ref": "#/definitions/Metadata"
        }
      },
      "required": [
        "_fw_name",
        "paths"
      ]
    },
    "GetFilesTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "GetFilesTask"
        },
        "identifiers": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "uniqueItems": true
        },
        "filepad_file": {
          "$ref": "generic.json#/AbsoluteFilePath"
        },
        "dest_dir": {
          "$ref": "generic.json#/FilePath"
        },
        "new_file_names": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Filename"
          },
          "uniqueItems": true
        }
      },
      "required": [
        "_fw_name",
        "identifiers"
      ]
    },
    "DeleteFilesTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "DeleteFilesTask"
        },
        "identifiers": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "uniqueItems": true
        },
        "filepad_file": {
          "$ref": "generic.json#/AbsoluteFilePath"
        }
      },
      "required": [
        "_fw_name",
        "identifiers"
      ]
    },
    "CommandLineTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "CommandLineTask"
        },
        "command_spec": {
          "type": "object",
          "additionalProperties": {
            "OneOf": [
              {
                "$ref": "generic.json#/Identifier"
              },
              {
                "type": "object",
                "properties": {
                  "binding": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "prefix": {
                        "type": [
                          "null",
                          "string"
                        ]
                      },
                      "separator": {
                        "type": [
                          "null",
                          "string"
                        ]
                      }
                    }
                  },
                  "source": {
                    "oneOf": [
                      {
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                          "type": {
                            "enum": [
                              "path",
                              "identifier",
                              "stdin",
                              "stdout",
                              "stderr",
                              null
                            ]
                          },
                          "value": {
                            "type": "string"
                          }
                        }
                      },
                      {
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                          "type": {
                            "const": "data"
                          },
                          "value": {
                            "type": [
                              "string",
                              "integer",
                              "number"
                            ]
                          }
                        }
                      },
                      {
                        "$ref": "generic.json#/Identifier"
                      }
                    ]
                  },
                  "target": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "type": {
                        "enum": [
                          "path",
                          "data",
                          "identifier",
                          "stdin",
                          "stdout",
                          "stderr",
                          null
                        ]
                      },
                      "value": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            ]
          },
          "properties": {
            "command": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "minItems": 1
            }
          },
          "required": [
            "command"
          ]
        },
        "inputs": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "default": []
        },
        "outputs": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "default": [],
          "uniqueItems": true
        },
        "chunk_number": {
          "oneOf": [
            {
              "type": "integer",
              "minimum": 0
            },
            {
              "const": null
            }
          ],
          "default": null
        }
      },
      "required": [
        "_fw_name",
        "command_spec"
      ]
    },
    "ForeachTask": {
      "properties": {
        "_fw_name": {
          "const": "ForeachTask"
        },
        "task": {
          "$ref": "#/Firetask"
        },
        "split": {
          "type": "string"
        },
        "number of chunks": {
          "type": "integer",
          "minimum": 1
        }
      },
      "required": [
        "_fw_name",
        "task",
        "split"
      ]
    },
    "JoinDictTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "JoinDictTask"
        },
        "inputs": {
          "type": "array",
          "items": {
            "$ref": "generic.json#/Identifier"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "output": {
          "$ref": "generic.json#/Identifier"
        },
        "rename": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "required": [
        "_fw_name",
        "inputs",
        "output"
      ]
    },
    "JoinListTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "JoinListTask"
        },
        "inputs": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "output": {
          "$ref": "generic.json#/Identifier"
        }
      },
      "required": [
        "_fw_name",
        "inputs",
        "output"
      ]
    },
    "ImportDataTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "const": "ImportDataTask"
        },
        "filename": {
          "$ref": "generic.json#/FilePath"
        },
        "mapstring": {
          "type": "string",
          "pattern": "^([^/]+/?[^/]+)+$"
        }
      },
      "required": [
        "_fw_name",
        "filename",
        "mapstring"
      ]
    },
    "GlobalSpecTask": {
      "additionalProperties": false,
      "properties": {
        "_fw_name": {
          "enum": [
            "ScriptTask",
            "FileTransferTask",
            "TemplateWriterTask"
          ]
        },
        "_use_global_spec": {
          "const": true
        }
      },
      "required": [
        "_fw_name",
        "_use_global_spec"
      ]
    },
    "CustomFiretask": {
      "properties": {
        "_fw_name": {
          "type": "string",
          "minLength": 1,
          "not": {
            "enum": [
              "ScriptTask",
              "PyTask",
              "FileWriteTask",
              "FileDeleteTask",
              "FileTransferTask",
              "CompressDirTask",
              "ArchiveDirTask",
              "TemplateWriterTask",
              "AddFilesTask",
              "GetFilesTask",
              "DeleteFilesTask",
              "CommandLineTask",
              "ForeachTask",
              "JoinDictTask",
              "JoinListTask",
              "ImportDataTask"
            ]
          }
        }
      },
      "required": [
        "_fw_name"
      ],
      "title": "Custom Firetask object"
    },
    "BuiltinFiretask": {
      "type": "object",
      "oneOf": [
        {
          "$ref": "#/definitions/ScriptTask"
        },
        {
          "$ref": "#/definitions/PyTask"
        },
        {
          "$ref": "#/definitions/FileWriteTask"
        },
        {
          "$ref": "#/definitions/FileDeleteTask"
        },
        {
          "$ref": "#/definitions/FileTransferTaskType1"
        },
        {
          "$ref": "#/definitions/FileTransferTaskType2"
        },
        {
          "$ref": "#/definitions/CompressDirTask"
        },
        {
          "$ref": "#/definitions/ArchiveDirTask"
        },
        {
          "$ref": "#/definitions/TemplateWriterTask"
        },
        {
          "$ref": "#/definitions/AddFilesTask"
        },
        {
          "$ref": "#/definitions/GetFilesTask"
        },
        {
          "$ref": "#/definitions/DeleteFilesTask"
        },
        {
          "$ref": "#/definitions/CommandLineTask"
        },
        {
          "$ref": "#/definitions/ForeachTask"
        },
        {
          "$ref": "#/definitions/JoinDictTask"
        },
        {
          "$ref": "#/definitions/JoinListTask"
        },
        {
          "$ref": "#/definitions/ImportDataTask"
        },
        {
          "$ref": "#/definitions/GlobalSpecTask"
        }
      ],
      "title": "Built-in Firetask object"
    },
    "Metadata": {
      "type": "object",
      "title": "Metadata object"
    }
  }
}
